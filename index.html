<!doctype html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<title>Food production in 2050</title>
	<meta name="author" content="Eliott Joulot, Maxence Petitpierre, Kevin Pelletier">
 
	<link rel="stylesheet" href="style.css">

	<!-- Bootstrap -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.6/umd/popper.min.js"></script>
  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

	<!-- Mapbox -->
	<script src='https://api.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.js'></script>
	<script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.3.0/mapbox-gl-geocoder.min.js'></script>
	<link href='https://api.mapbox.com/mapbox-gl-js/v0.51.0/mapbox-gl.css' rel='stylesheet' />
	<link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.3.0/mapbox-gl-geocoder.css' type='text/css' />


	<script type="text/javascript">
	    function defaultSSP() {
            document.getElementById("SSP1").style.display = "inline";
			//$('.help-modal').modal('show');
        }
        window.onload = defaultSSP;
    </script>

</head>

<body>
<div class="page_container">

	<nav class="navbar navbar-expand-lg navbar-dark">
		<a class="navbar-brand" href="index.html">Home</a>
		<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
		
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav mr-auto">
				<li class="nav-item active">
					<a class="nav-link" href="info.html">Info</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="story.html">Story</a>
				</li>
			</ul>
			<form class="form-inline my-2 my-lg-0">
				<button class="btn btn-outline-light my-2 my-sm-0" type="button" data-toggle="modal" data-target=".help-modal">Help</button>
			</form>
		</div>
	</nav>


	<div class="content">
		<h1>
			Food production in 2050
		</h1>

		<div class="row">
			
			<div class="col-xs-12 col-sm-10 container map-container" style="padding: 0px 20px 0px 0px; background-color: white">
				
				<div id='map' style='width: 100%; height: 100%;border-radius: 10px;border: 1px solid #dedddd;'>
				
					<div style="height: 100%;background-color: #000000b3;position: relative;">
						<img alt="animated" style="height: 100px;top: 38%;position: sticky;width: 100%;" src="src/svg/earth-spinner.svg">
						<p style="top: 37%;color: white;text-align: center;position: relative;font-size: larger;font-weight: bold;">Loading...</p>
					</div>
					
				</div>
				<script>
					mapboxgl.accessToken = 'pk.eyJ1IjoiZWxpb3R0am91bG90IiwiYSI6ImNqb3BxbWNsNTA2OWszcWsyZmhyb2RwMmcifQ.8hum7VUmAlj4syS3GZwFLA';
					var map = new mapboxgl.Map({
						container: 'map',
						style: 'mapbox://styles/eliottjoulot/cjosk4zex021a2spdbg1k1zkq',
						center: [15, 30], // starting position
						zoom: 1, // starting zoom
						maxZoom: 14,
    					minZoom: 1
					});

					map.on('load', function () {
						//let dataSelect = "SSP1";
						//displayMap()
						console.log("On load map");
						
						map.addSource("earthquakes", {
							type: "geojson",
							// Point to GeoJSON data. This example visualizes all M1.0+ earthquakes
							// from 12/22/15 to 1/21/16 as logged by USGS' Earthquake hazards program.
							data: "geo_calories_filtered_SSP1cc.geojson",
							cluster: false,
							clusterMaxZoom: 6, // Max zoom to cluster points on
							clusterRadius: 10 // Radius of each cluster when clustering points (defaults to 50)
						});
						
						map.addLayer({
							"id": "earthquakes-heat",
							"type": "heatmap",
							"source": "earthquakes",
							"maxzoom": 10,
							"paint": {
								// Increase the heatmap weight based on frequency and property magnitude
								"heatmap-weight": [
									"interpolate",
									["linear"],
									["get", "calories"],
									22000, 0,
									35000, 1
								],
								// Increase the heatmap color weight weight by zoom level
								// heatmap-intensity is a multiplier on top of heatmap-weight
								"heatmap-intensity": [
									"interpolate",
									["linear"],
									["zoom"],
									0, 1,
									9, 10
								],
								// Color ramp for heatmap.  Domain is 0 (low) to 1 (high).
								// Begin color ramp at 0-stop with a 0-transparancy color
								// to create a blur-like effect.
								"heatmap-color": [
									"interpolate",
									["linear"],
									["heatmap-density"],
									0, "rgba(33,102,172,0)",
									0.2, "rgba(103,169,207,0.5)",
									0.4, "rgba(209,229,240,0.5)",
									0.6, "rgba(253,219,199,0.5)",
									0.8, "rgba(239,138,98,0.5)",
									1, "rgba(178,24,43,0.5)"
								],
								// Adjust the heatmap radius by zoom level
								"heatmap-radius": [
									"interpolate",
									["linear"],
									["zoom"],
									0, 2,
                					8, 30
								],
								// Transition from heatmap to circle layer by zoom level
								"heatmap-opacity": [
									"interpolate",
									["linear"],
									["zoom"],
									12, 1,
									14, 0
								],
							}
						});

						map.addLayer({
							"id": "earthquakes-point",
							"type": "circle",
							"source": "earthquakes",
							"minzoom": 1,
							"paint": {
								// Size circle radius by earthquake magnitude and zoom level
								"circle-radius": [
									"interpolate",
									["linear"],
									["zoom"],
									1, [
										"interpolate",
										["linear"],
										["get", "calories"],
										8600, 1,
										35000, 2
									],
									16, [
										"interpolate",
										["linear"],
										["get", "calories"],
										8600, 5,
										35000, 20
									]
								],
								// Color circle by earthquake magnitude
								"circle-color": [
									"interpolate",
									["linear"],
									["get", "calories"],
									8000, "rgba(0,255,0,0)",
									18000, "rgba(0,0,255,0.3)",
									26000, "rgba(255,0,0,0.3)"
								],
								// Transition from heatmap to circle layer by zoom level
								"circle-opacity": [
									"interpolate",
									["linear"],
									["zoom"],
									7, 0,
									8, 1
								]
							}
						});








						// inspect a cluster on click
						map.on('click', 'clusters', function (e) {
							var features = map.queryRenderedFeatures(e.point, { layers: ['clusters'] });
							var clusterId = features[0].properties.cluster_id;
							map.getSource('earthquakes').getClusterExpansionZoom(clusterId, function (err, zoom) {
								if (err)
									return;

								map.easeTo({
									center: features[0].geometry.coordinates,
									zoom: zoom
								});
							});
						});

						map.on('mouseenter', 'clusters', function () {
							map.getCanvas().style.cursor = 'pointer';
						});
						map.on('mouseleave', 'clusters', function () {
							map.getCanvas().style.cursor = '';
						});
						
						// Search box
						map.addControl(new MapboxGeocoder({
							accessToken: mapboxgl.accessToken
						}), 'top-left');

						// Add zoom and rotation controls to the map.
						map.addControl(new mapboxgl.NavigationControl(), 'top-left');

						// Full-screen toggle
						map.addControl(new mapboxgl.FullscreenControl());
	
						
					});
					
					function displayMap()	{

						map.removeLayer("earthquakes-heat");
						map.removeSource("earthquakes");

						let dataSelect = document.getElementById("exampleFormControlSelect1").value;
						
						// SSP1 is the default scenario
						if(dataSelect == null) {
							dataSelect = "SSP1";
						}
						
						//map.removeLayer('earthquakes-heat');
						
						console.log("Display data : " + dataSelect);

						console.log("Data file : " + "geo_calories_filtered_" + dataSelect + "cc.geojson");

						map.addSource("earthquakes", {
							type: "geojson",
							// Point to GeoJSON data. This example visualizes all M1.0+ earthquakes
							// from 12/22/15 to 1/21/16 as logged by USGS' Earthquake hazards program.
							//data: "geo_calories_filtered_SSP1cc.geojson",
							data: "geo_calories_filtered_" + dataSelect + "cc.geojson",
							cluster: false,
							clusterMaxZoom: 6, // Max zoom to cluster points on
							clusterRadius: 10 // Radius of each cluster when clustering points (defaults to 50)
						});

						map.addLayer({
							"id": "earthquakes-heat",
							"type": "heatmap",
							"source": "earthquakes",
							"maxzoom": 10,
							"paint": {
								// Increase the heatmap weight based on frequency and property magnitude
								"heatmap-weight": [
									"interpolate",
									["linear"],
									["get", "calories"],
									22000, 0,
									35000, 1
								],
								// Increase the heatmap color weight weight by zoom level
								// heatmap-intensity is a multiplier on top of heatmap-weight
								"heatmap-intensity": [
									"interpolate",
									["linear"],
									["zoom"],
									0, 1,
									9, 10
								],
								// Color ramp for heatmap.  Domain is 0 (low) to 1 (high).
								// Begin color ramp at 0-stop with a 0-transparancy color
								// to create a blur-like effect.
								"heatmap-color": [
									"interpolate",
									["linear"],
									["heatmap-density"],
									0, "rgba(33,102,172,0)",
									0.2, "rgba(103,169,207,0.5)",
									0.4, "rgba(209,229,240,0.5)",
									0.6, "rgba(253,219,199,0.5)",
									0.8, "rgba(239,138,98,0.5)",
									1, "rgba(178,24,43,0.5)"
								],
								// Adjust the heatmap radius by zoom level
								"heatmap-radius": [
									"interpolate",
									["linear"],
									["zoom"],
									0, 2,
                					8, 30
								],
							}
						});
					}

				</script>

				

			</div>
			<div class="col col-sm-2 container" style="height: auto;">
				<form>
					<div class="form-group" style="margin-bottom: 30px">
						<label for="exampleFormControlSelect1">Model</label>
						<select class="form-control" id="exampleFormControlSelect1" onchange="displayInfo()" onchange="displayMap()">
							<option selected value="SSP1">SSP 1</option>
							<option value="SSP2">SSP 2</option>
							<option value="SSP3">SSP 3</option>
							<option value="SSP4">SSP 4</option>
							<option value="SSP5">SSP 5</option>
						</select>
					</div>

					<div class="form-check" style="margin-bottom: 10px">
						<input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" value="MR" checked>
						<label class="form-check-label" for="exampleRadios1">MR</label>
					</div>
					<div class="form-check" style="margin-bottom: 10px">
						<input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" value="CC">
						<label class="form-check-label" for="exampleRadios2">CC</label>
					</div>
					<div class="form-check" style="margin-bottom: 10px">
						<input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" value="HE">
						<label class="form-check-label" for="exampleRadios2">HE</label>
					</div>
					<div class="form-check" style="margin-bottom: 10px">
						<input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" value="GS">
						<label class="form-check-label" for="exampleRadios2">GS</label>
					</div>

				</form>
			</div>
		</div>
		<div class="row">
			<div class="col container info-container anyClass">				
				<div class="SSP" id="SSP1">
						<h4>
							SSP1: Sustainability—Taking the green road
						</h4>

						<p>
							The world shifts gradually, but pervasively, toward a more sustainable path, emphasizing more inclusive development that respects perceived environmental boundaries. Increasing evidence of and accounting for the social, cultural, and economic costs of environmental degradation and inequality drive this shift. Management of the global commons slowly improves, facilitated by increasingly effective and persistent cooperation and collaboration of local, national, and international organizations and institutions, the private sector, and civil society. Educational and health investments accelerate the demographic transition, leading to a relatively low population. 
							<br>Beginning with current high-income countries, the emphasis on economic growth shifts toward a broader emphasis on human well-being, even at the expense of somewhat slower economic growth over the longer term. Driven by an increasing commitment to achieving development goals, inequality is reduced both across and within countries. Investment in environmental technology and changes in tax structures lead to improved resource efficiency, reducing overall energy and resource use and improving environmental conditions over the longer term. Increased investment, financial incentives and changing perceptions make renewable energy more attractive. Consumption is oriented toward low material growth and lower resource and energy intensity.
						</p>
				</div>

				<div class="SSP" id="SSP2">
					<h4>
						SSP2: Middle of the road
					</h4>

					<p>
						The world follows a path in which social, economic, and technological trends do not shift markedly from historical patterns. Development and income growth proceeds unevenly, with some countries making relatively good progress while others fall short of expectations. Most economies are politically stable. Globally connected markets function imperfectly. Global and national institutions work toward but make slow progress in achieving sustainable development goals, including improved living conditions and access to education, safe water, and health care. Technological development proceeds apace, but without fundamental breakthroughs.
					</p>
				</div>

				<div class="SSP" id="SSP3">
					<h4>
						SSP3: Regional Rivalry – A Rocky Road
					</h4>
						A resurgent nationalism, concerns about competitiveness and security, and regional conflicts push countries to increasingly focus on domestic or, at most, regional issues. Policies shift over time to become increasingly oriented toward national and regional security issues. Countries focus on achieving energy and food security goals within their own regions at the expense of broader-based development. Investments in education and technological development decline. Economic development is slow, consumption is material-intensive, and inequalities persist or worsen over time. Population growth is low in industrialized and high in developing countries. A low international priority for addressing environmental concerns leads to strong environmental degradation in some regions.
				</div>

				<div class="SSP" id="SSP4">
					<h4>
						SSP4: Inequality – A Road Divided 
					</h4>
						Highly unequal investments in human capital, combined with increasing disparities in economic opportunity and political power, lead to increasing inequalities and stratification both across and within countries. Over time, a gap widens between an internationally-connected society that contributes to knowledge- and capital-intensive sectors of the global economy, and a fragmented collection of lower-income, poorly educated societies that work in a labor intensive, low-tech economy. Social cohesion degrades and conflict and unrest become increasingly common. Technology development is high in the high-tech economy and sectors. The globally connected energy sector diversifies, with investments in both carbon-intensive fuels like coal and unconventional oil, but also low-carbon energy sources. Environmental policies focus on local issues around middle and high income 
		
				</div>

				<div class="SSP" id="SSP5">
					<h4>
						SSP5: Fossil-fueled Development
					</h4>
						This world places increasing faith in competitive markets, innovation and participatory societies to produce rapid technological progress and development of human capital as the path to sustainable development. Global markets are increasingly integrated. There are also strong investments in health, education, and institutions to enhance human and social capital. At the same time, the push for economic and social development is coupled with the exploitation of abundant fossil fuel resources and the adoption of resource and energy intensive lifestyles around the world. 
						<br>All these factors lead to rapid growth of the global economy, while global population peaks and declines in the 21st century. Local environmental problems like air pollution are successfully managed. There is faith in the ability to effectively manage social and ecological systems, including by geo-engineering if necessary.
					
				</div>


			</div>
		</div>
	</div>



	<footer>
		<p>COM-480 Data Visualization, academic project teached by <a href="https://www.kirellbenzi.com/fr/" target="_blank">Kirell Benzi</a></p>
		<ul>
			<li><a href="https://www.linkedin.com/in/eliottjoulot/" target="_blank">Eliott Joulot</a></li>
			<li><a href="https://www.linkedin.com/in/maxence-petitpierre/?locale=en_US" target="_blank">Maxence Petitpierre</a></li>
			<li><a href="https://www.linkedin.com/in/pelletier-kevin/?locale=en_US" target="_blank">Kevin Pelletier</a></li>
		</ul>
		
		<a href="https://www.epfl.ch" target="_blank"><img src="src/images/EPFL.png" alt="EPFL" height="50" style="margin-right: 20px"></a>
		<a href="https://naturalcapitalproject.stanford.edu" target="_blank"><img src="src/images/natcap.png" alt="NatCap" height="50"></a>
	</footer>



	<script src="help_popup.js"></script>
	
	<script src="lib/d3.min.js"></script>
	<script src="lib/topojson.min.js"></script>
	<script src="main.js"></script>

</div>
</body>

<!-- Help modal -->
<div class="modal fade help-modal" tabindex="-1" role="dialog" aria-labelledby="helpModal" aria-hidden="true">
	<div class="modal-dialog modal-lg modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="exampleModalLabel">How to use</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body" w3-include-html="content.html">
				<h5>We highly recommend to use Chrome for a smoother experience !</h5>
				<p id="browser_check">
					 <script>
						// Opera 8.0+
						var isOpera = (!!window.opr && !!opr.addons) || !!window.opera || navigator.userAgent.indexOf(' OPR/') >= 0;
					
						// Firefox 1.0+
						var isFirefox = typeof InstallTrigger !== 'undefined';
					
						// Safari 3.0+ "[object HTMLElementConstructor]" 
						var isSafari = /constructor/i.test(window.HTMLElement) || (function (p) { return p.toString() === "[object SafariRemoteNotification]"; })(!window['safari'] || safari.pushNotification);
					
						// Internet Explorer 6-11
						var isIE = /*@cc_on!@*/false || !!document.documentMode;
					
						// Edge 20+
						var isEdge = !isIE && !!window.StyleMedia;
					
						// Chrome 1+
						var isChrome = !!window.chrome && !!window.chrome.webstore;
					
						var output = '<br>Detecting browser used:<hr>';
						output += 'isFirefox: ' + isFirefox + '<br>';
						output += 'isChrome: ' + isChrome + '<br>';
						output += 'isSafari: ' + isSafari + '<br>';
						output += 'isOpera: ' + isOpera + '<br>';
						output += 'isIE: ' + isIE + '<br>';
						output += 'isEdge: ' + isEdge + '<br>';

						document.getElementById("browser_check").innerHTML = output;
					 </script>
				</p>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

<script>
let selectedSSP = document.getElementById("exampleFormControlSelect1").value;
function displayInfo() {

	//var selected = "SSP_1"
	if(selectedSSP != null) {
		//console.log(selectedSSP);
		document.getElementById(selectedSSP).style.display = "none";
	}
    selectedSSP = document.getElementById("exampleFormControlSelect1").value;

    console.log("Display info : " + selectedSSP);
    //console.log(selectedSSP);
	document.getElementById(selectedSSP).style.display = "inline";
	displayMap();

}


</script>



</html>